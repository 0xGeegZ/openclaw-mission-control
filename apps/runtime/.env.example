# Runtime service environment variables
# Copy to .env in this directory (apps/runtime). Load manually or via your process manager.
# See README.md for how this service fits in OpenClaw Mission Control.

# --- Required ---
# Convex account ID this runtime serves (Id<"accounts"> from Convex).
ACCOUNT_ID=

# Convex deployment URL (same deployment as the web app).
CONVEX_URL=https://your-deployment.convex.cloud

# Service authentication token. Used to call Convex service-only actions.
# Must be scoped to the account; create via your Convex auth setup.
SERVICE_TOKEN=

# --- Optional (defaults in parentheses) ---
# Port for the health HTTP server (GET /health, GET /version).
HEALTH_PORT=3000

# Notification delivery poll interval in milliseconds.
DELIVERY_INTERVAL=15000

# Interval in ms for reporting runtime status to Convex (online/versions).
HEALTH_CHECK_INTERVAL=300000

# Interval in ms for syncing agent list from Convex (new agents picked up without restart; default 300000).
# AGENT_SYNC_INTERVAL=300000

# Runtime service version (defaults to package.json version).
# RUNTIME_VERSION=0.1.0

# OpenClaw version override if detection fails (default: detected via openclaw --version).
# OPENCLAW_VERSION=

# --- Logging & observability ---
# Log level: debug | info | warn | error (default: info).
# LOG_LEVEL=info

# Bind address for health HTTP server (default: 127.0.0.1 for local-only).
# Use 0.0.0.0 when running in Docker so healthcheck can reach the server.
# HEALTH_HOST=127.0.0.1

# --- Delivery backoff (on poll errors) ---
# Base delay in ms for exponential backoff (default: 5000).
# DELIVERY_BACKOFF_BASE_MS=5000
# Max delay in ms (default: 300000 = 5 min).
# DELIVERY_BACKOFF_MAX_MS=300000
#
# --- Delivery parallelization (notification delivery by session) ---
# Max concurrent session streams per poll cycle (default: 10). Clamped to 1–100.
# DELIVERY_MAX_CONCURRENT_SESSIONS=10
# Per-session-stream timeout in ms; one stuck stream does not block the cycle (default: 2× OPENCLAW_REQUEST_TIMEOUT_MS). Clamped to 5000–(2× openclaw timeout).
# DELIVERY_STREAM_TIMEOUT_MS=
# Batch size for parallel getNotificationForDelivery fetches (default: 15). Clamped to 1–50.
# DELIVERY_CONTEXT_FETCH_BATCH_SIZE=15
# Max notifications to list per poll cycle (default: 50). Clamped to 1–500.
# DELIVERY_LIST_LIMIT=50

# When upgrade/restart is requested: "exit" (default) exits so process manager restarts.
# UPGRADE_MODE=exit

# --- OpenClaw gateway (when using docker-compose with profile openclaw) ---
# Gateway base URL for OpenResponses (POST /v1/responses). Default: http://127.0.0.1:18789.
# In Docker with profile openclaw use: OPENCLAW_GATEWAY_URL=http://openclaw-gateway:18789
# OPENCLAW_GATEWAY_URL=http://127.0.0.1:18789
# Gateway auth token (Bearer). Optional for local gateway URLs; required for non-local URLs.
# Set empty to allow no-auth local gateway (will bind to localhost only).
# OPENCLAW_GATEWAY_TOKEN=
# Timeout for /v1/responses requests in ms (default 300000). Clamped to 5000–600000 if out of range.
# OPENCLAW_REQUEST_TIMEOUT_MS=300000
# Enable/disable client-side tools sent via OpenResponses (default true).
# OPENCLAW_CLIENT_TOOLS_ENABLED=true
# Base URL the OpenClaw gateway (agent) uses to reach the runtime for task-status HTTP fallback.
# Defaults to http://{HEALTH_HOST}:{HEALTH_PORT} when unset. From inside the gateway container,
# 127.0.0.1 is the gateway, not the runtime — so with Docker Compose set e.g.:
# TASK_STATUS_BASE_URL=http://runtime:3000
# TASK_STATUS_BASE_URL=
#
# --- Profile sync (per-agent OpenClaw workspaces and generated config) ---
# Root directory for per-agent workspaces (SOUL.md, TOOLS.md, etc.). Default: /root/clawd/agents
# OPENCLAW_WORKSPACE_ROOT=/root/clawd/agents
# Derived internally from OPENCLAW_WORKSPACE_ROOT:
# - generated OpenClaw config: <workspace parent>/openclaw.json
# - runtime HEARTBEAT source:  <workspace parent>/HEARTBEAT.md (fallback)
# Set to "true" to enable profile sync (workspaces and openclaw.json); required to populate SOUL.md, AGENTS.md, TOOLS.md per agent. Default is disabled.
# OPENCLAW_PROFILE_SYNC=true
# When set to "1" (OpenClaw gateway container only), gateway watches generated config and restarts on change.
# OPENCLAW_CONFIG_RELOAD=0
#
# Optional session store prune on OpenClaw startup:
# - Set to a number of days to remove stale session entries.
# - Set to 0 to clear all session entries (safe; they recreate on demand).
# OPENCLAW_SESSION_RETENTION_DAYS=
# Gateway main-lane concurrency: max parallel agent runs across sessions (default 5). Clamped to 1–16. Set so Lead can respond in orchestrator and task threads at once.
# OPENCLAW_MAX_CONCURRENT=5
# Vercel AI Gateway API key (recommended). Mapped to AI_GATEWAY_API_KEY for OpenClaw.
# VERCEL_AI_GATEWAY_API_KEY=
# Optional direct key (overrides mapping if set).
# AI_GATEWAY_API_KEY=
# Brave Search API key for OpenClaw web_search (bird skill). Use "Data for Search" plan at brave.com/search/api.
# BRAVE_API_KEY=
# Optional managed-browser binary override for the OpenClaw gateway.
# If unset, startup auto-detects in this order: brave-browser, chromium, chromium-browser.
# OPENCLAW_BROWSER_EXECUTABLE_PATH=
#
# GitHub token for agent git push and PR creation (avoids `gh auth login` prompts).
# Required scopes: Contents read+write, Pull requests read+write (fine-grained) or repo (classic).
# Optional: GIT_AUTHOR_NAME, GIT_AUTHOR_EMAIL for commit identity.
# GH_TOKEN=
#
# --- Infrastructure (for tracking; reported in health and Convex) ---
# DigitalOcean droplet identifier.
# DROPLET_ID=
# DROPLET_IP=
# DROPLET_REGION=
